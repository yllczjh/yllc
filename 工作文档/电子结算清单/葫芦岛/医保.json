1登记唯一号|2账户余额362.13|3医疗待遇类别(参保人员类别)|4个人编号|
5社会保障卡号|6结算单号|7医疗费总额9072.61|8起付标准金额400.00|9个人帐户支付金额461.69|
10按比例支付金额591.37|11部分先自付金额70.22|12超限额报销0.00|13超限额自付0.00|
14超最高限额自付0.00|15全自费金额1210.29|16现金支付额1810.19|17限门诊用药金额0|
18统筹不报销金额0|19统筹基金报销金额6800.73|20个人帐户余额0|
21公务员最高支付限额以上部分报销金额0|22困难人员标识（原低保标识）0|
23公务员个人自付报销金额0|24公务员补助报销金额0.00|25本次进入统筹医疗费用金额7392.10|
26全自费金额0.00|27人员类别|28入院日期|29出院日期|30主管医师|31个人报销状态|
32姓名|33住院流水号|34住院次数|35住院天数|36诊治结果|37实际缴费月数|
38身份证号码|39出院疾病名称|40医疗类别|41个人编号|42视同缴费月数|
43医疗机构编码|44费用结算日期|45商保不报销金额0|46按正常统筹支出比例1|
47上次进入统筹医疗费用累计0.00|48个人所属行政区划|49（预留）0|
50医保范围内报销自付比例0.08|51自付合规医疗费报销0.00|52民政救助报销金额0.00|
53工伤补助报销金额0.00|54报销总额6800.73|55补充医疗保险基金0.00|
56伤残人员医疗保障基金0.00|57其它基金支付0.00|58医疗类别|59个人统筹区号|
60治疗方式|




select t.病历号,
       t.c_7    as 医疗费总额,
       t.c_25   as 本次进入统筹医疗费用金额,
       t.c_19   as 统筹基金报销金额,
       t.c_50   as 医保范围内报销自付比例,
       t.c_10   as 按比例支付金额,
       t.c_8    as 起付标准金额,
       t.c_15   as 全自费金额,
       t.c_11   as 部分先自付金额,
       t.c_16   as 现金支付额,
       t.c_9    as 个人帐户支付金额
  from 接口管理_接口补偿信息 t
 where t.就诊类型 = '住院'
 
 
 
 
 
 
 
 select g.住院病历号,
       g.费用编码,
       g.费用名称,
       sum(总金额) 金额,
       nvl(sum(case 医保类型
                 when '甲类' then
                  总金额
               end),
           0) as 甲类,
       nvl(sum(case 医保类型
                 when '乙类' then
                  总金额
               end),
           0) as 乙类,
       nvl(sum(case 医保类型
                 when '丙类' then
                  总金额
               end),
           0) as 自费,
           0 as 其他

  from (select a.住院病历号,
               
               decode(b.隶属编码,
                      '33',--床位费
                      '01',
                      '20',--诊察费
                      '02',
                      '10',--检查费
                      '03',
                      '7',--化验费
                      '04',
                      '19',--治疗费
                      '05',
                      '5',--手术费
                      '06',
                      '16',--护理费
                      '07',
                      '49',--卫生材料费
                      '08',
                      '1',--西药费
                      '09',
                      '3',--中药饮片费
                      '10',
                      '2',--中成药费
                      '11',
                      '55',--一般诊疗费
                      '12',
                      '11',--挂号费
                      '13',
                      '14') as 费用编码,
               decode(b.隶属编码,
                      '33',
                      '床位费',
                      '20',
                      '诊察费',
                      '10',
                      '检查费',
                      '7',
                      '化验费',
                      '19',
                      '治疗费',
                      '5',
                      '手术费',
                      '16',
                      '护理费',
                      '49',
                      '卫生材料费',
                      '1',
                      '西药费',
                      '3',
                      '中药饮片费',
                      '2',
                      '中成药费',
                      '55',
                      '一般诊疗费',
                      '11',
                      '挂号费',
                      '其他费') as 费用名称,
               a.总金额,
               nvl(case
                     when a.大类编码 = '1' then
                      (select z.医保
                         from 基础项目_诊疗字典 z
                        where z.机构编码 = a.机构编码
                          and z.项目编码 = a.项目编码)
                     when a.大类编码 = '2' then
                      (select y.医保
                         from 基础项目_药品字典 y
                        where y.机构编码 = a.机构编码
                          and y.药品编码 = a.项目编码)
                   end,
                   '丙类') as 医保类型
          from 住院管理_出院病人处方 a, 基础项目_费用归类 b
         where a.机构编码 = b.机构编码
           and a.归类编码 = b.费用编码
           and a.记账时间 >= to_date('2019-01-01', 'yyyy-MM-dd')
           and b.类别 = '住院发票项目归类'
           and b.删除标志 = '0') g
 group by g.住院病历号, g.费用编码, g.费用名称
 order by g.住院病历号, g.费用编码




dtsdts
sjsb
